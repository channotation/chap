# Using singularity containers for chap #

Singularity is an open-source software for container-virtualization. 
Containers offer a way to use a pre-built software in a closed and reproducible space, 
independent from the environment. A Singularity container contains its own operating system
(here: Ubuntu), the intended software (chap) and all required dependencies (gromacs 2018 and 
everything else such as cmake, gcc, boost, CBLAS and LAPACKE libraries).
If you download the one of the singularity containers provided here and you have
singularity installed on your workstation or cluster, you do not need to install chap
or any of its dependencies.

This means running chap is easily done by:-

1.  Installing singularity (via apt-get for example)
2.  Downloading the singularity image here, running it and then issueing the chap command on your files


### installing singularity ###
version 2: https://sylabs.io/guides/2.6/user-guide/singularity_flow.html

version 3: https://sylabs.io/guides/3.8/user-guide/quick_start.html

The .sif file was built with singularity version3. 
The .simg file was built with version2 of singularity.
Type "singularity --version" in your terminal to check 
which version is installed on your machine or your cluster.
If you have version 3 installed, you can use both the .sif or the .simg file.
If you have version 2 installed, you can only use the .simg file.

### Usage ###
singularity shell --nv chap_singularity_version2.simg

or

singularity shell --nv chap_sing.sif

chap -f 6v9x.pdb -s 6v9x.pdb -sel-pathway 1

The file 6v9x.pdb is just an example.
After being in the singularity environment, you have to change directorty 
to the folder where your trajectories/pdb files are stored to use chap for
analysis. Or you load the files in the same folder where the singularity
folder is stored.

### tpr files ###
If you analyse gromacs trajectories, you need to input a tpr file generated by
gromacs 2018 or older. We are currently working on updating chap such that it can 
read tpr files from current gromacs versions.

### Installing singularity for windows/mac ###
https://sylabs.io/guides/3.5/admin-guide/installation.html

Linux container runtimes like Singularity cannot run natively on Windows or Mac 
because of basic incompatibilities with the host kernel.

For this reason, the Singularity community maintains a set of Vagrant Boxes via Vagrant Cloud, 
one of Hashicorpâ€™s open source tools. The current versions can be found under the sylabs organization.

Sylabs has also developed a beta version of Singularity Desktop for Mac, 
which runs Singularity in a lightweight virtual machine, in a transparent manner.

We have tested the version 3 sif container with mac (OS Catalina) and that seems to work fine.  We have not tested other versions of mac or windows.   Let us know i if you have experience of that!
