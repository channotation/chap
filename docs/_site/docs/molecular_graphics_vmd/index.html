<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Molecular Graphics in VMD</title>
    <meta name="description" content="">


    <link rel="stylesheet" href="/chap/css/main.css">
    <link rel="stylesheet" href="/chap/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/chap/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.2 -->
<title>Molecular Graphics in VMD | CHAP</title>
<meta property="og:title" content="Molecular Graphics in VMD" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/chap/docs/molecular_graphics_vmd/" />
<meta property="og:url" content="http://localhost:4000/chap/docs/molecular_graphics_vmd/" />
<meta property="og:site_name" content="CHAP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-15T21:33:50+00:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Molecular Graphics in VMD","datePublished":"2018-02-15T21:33:50+00:00","dateModified":"2018-02-15T21:33:50+00:00","url":"http://localhost:4000/chap/docs/molecular_graphics_vmd/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://localhost:4000/chap/docs/molecular_graphics_vmd/">
    <link rel="alternate" type="application/rss+xml" title="CHAP" href="http://localhost:4000/chap/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/chap/">
                <span><img src="/chap/img/logonav.png"></span> CHAP
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/chap/docs/home/">Documentation</a></li>
                <li ><a href="/chap/publications.html">Publications</a></li>
                <li ><a href="/chap/blog/2018/01/26/chap-at-bps/">News</a></li>
                <li ><a href="/chap/aboutus.html">About Us</a></li>
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href=""><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>



    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
          Getting Started
        </a>
      </h4>
    </div>
    <div id="collapse-1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/home/">What CHAP Can Do</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/installing_chap/">Installing CHAP</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/annotation_example/">Annotation Example</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
          Running CHAP
        </a>
      </h4>
    </div>
    <div id="collapse-2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/chap_workflow/">Overview of CHAP Workflow</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/input_parameters/">Input Parameters</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
          Understanding Output
        </a>
      </h4>
    </div>
    <div id="collapse-3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/overview_output/">Overview of Output Files</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_json_file/">Contents of the JSON Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_pdb_file/">Contents of the PDB Output File</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/contents_objmtl_file/">Contents of the OBJ and MTL Output Files</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
          Visualising Results
        </a>
      </h4>
    </div>
    <div id="collapse-4" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/plotting_python/">Plotting in Python</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/plotting_r/">Plotting in R</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/molecular_graphics_pymol/">Molecular Graphics in PyMOL</a>
        
          
          
          <a class="list-group-item active" href="/chap/docs/molecular_graphics_vmd/">Molecular Graphics in VMD</a>
        
      </ul>
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
          Data Sources
        </a>
      </h4>
    </div>
    <div id="collapse-5" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
      <ul class="list-group">
        
          
          
          <a class="list-group-item " href="/chap/docs/vdw_radii/">Van der Waals Radii</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/hydrophobicity_scales/">Hydrophobicity Scales</a>
        
          
          
          <a class="list-group-item " href="/chap/docs/colour_palettes/">Colour Palettes</a>
        
      </ul>
    </div>
  </div>

</div>

        </div>

        <div class="col-md-8">
            <h1>Molecular Graphics in VMD</h1>
            <div id="markdown-content-container">
<p>CHAP writes a triangle mesh representation of the computed pore surface to a <a href="http://www.fileformat.info/format/wavefrontobj/egff.htm">Wavefront OBJ file</a>. Unfortunately, <a href="http://www.ks.uiuc.edu/Research/vmd/">VMD</a> does not natively support the import of Wavefront OBJ meshes, which is why CHAP comes bundled with Tcl code that supports reading and visualising OBJ files using <a href="http://www.ks.uiuc.edu/Research/vmd/current/ug/node127.html">VMD’s draw command</a>. CHAP also provides a turnkey Tcl script for visualising the permeation pathway together with the channel protein.</p>

<h2 id="loading-and-displaying-obj-files">Loading and Displaying OBJ Files</h2>

<p>The code for loading and displaying OBJ data can by found in the file <code class="highlighter-rouge">wobj.tcl</code>, which is located under <code class="highlighter-rouge">chap/scripts/visualisation/VMD/</code> in your CHAP install directory. Assuming that you copied <code class="highlighter-rouge">wobj.tcl</code> to your working directory, you can load it into VMD by opening the Tk Console (under <code class="highlighter-rouge">Extensions &gt; Tk Console</code> in the VMD menu) and typing:</p>

<div class="language-tcl highlighter-rouge"><pre class="highlight"><code><span class="nb">source</span> wobj.tcl
</code></pre>
</div>

<p>This will make the functions <code class="highlighter-rouge">import_wobj</code> and <code class="highlighter-rouge">draw_wobj</code> available. The first of these can be used to load data from an OBJ file and the second function can be used to draw either the entire mesh or individual groups of faces. Both functions are contained within a namespace called <code class="highlighter-rouge">WOBJ</code>, so to load data from <code class="highlighter-rouge">output.obj</code>, you need to type:</p>

<div class="language-tcl highlighter-rouge"><pre class="highlight"><code><span class="k">set</span> obj <span class="p">[</span>WOBJ::import_wobj <span class="s2">"output.obj"</span><span class="p">]</span>
</code></pre>
</div>

<p>You can now display the permeation pathway coloured by e.g. solvent density by typing:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>WOBJ::draw_wobj $obj "avg_density"
</code></pre>
</div>

<p>Note that if the second argument to <code class="highlighter-rouge">draw_wobj</code> is a string that does not match any of the group names in <code class="highlighter-rouge">output.obj</code> the pore will be drawn in solid colour.</p>

<p>As VMD’s <code class="highlighter-rouge">draw</code> command adds elements to the molecule as a whole, it is unfortunately not possible to add different surface colours as individual representations that can be switched off or on through the GUI and pathway visualisation has to be controlled manually through VMD’s Tk console.</p>

<h2 id="turnkey-visualisation-script">Turnkey Visualisation Script</h2>

<p>To allow quick visualisation of CHAP results in VMD, the directory <code class="highlighter-rouge">chap/scripts/visualisation/VMD/</code> also contains the Tcl script <code class="highlighter-rouge">visualise_pathway.tcl</code>, which loads data from both <code class="highlighter-rouge">output.pdb</code> and <code class="highlighter-rouge">output.obj</code> to visualise the channel protein together with permeation pathway. Internally, this script uses functions defined in <code class="highlighter-rouge">wobj.tcl</code>, so you need to make sure that <code class="highlighter-rouge">wobj.tcl</code> is located either in your working directory or in the same directory as <code class="highlighter-rouge">visualise_pathway.tcl</code>.</p>

<p>The <code class="highlighter-rouge">visualise_pathway.tcl</code> script can be started either from within VMD by typing</p>

<div class="language-tcl highlighter-rouge"><pre class="highlight"><code><span class="nb">source</span> visualise_pathway.tcl
</code></pre>
</div>

<p>in the Tk console or directly from the command line as part of the VMD invocation by typing:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>vmd -e visualise_pathway.tcl
</code></pre>
</div>

<p>If the second approach is used, <code class="highlighter-rouge">wobj.tcl</code> needs to be in the current working directory.</p>

<p>By default, <code class="highlighter-rouge">visualise_pathway.tcl</code> assumes that the data files are called <code class="highlighter-rouge">output.obj</code> and <code class="highlighter-rouge">output.pdb</code>. In order to use custom file names, you need to set the variables <code class="highlighter-rouge">FILE_PORE_SURFACE</code> and <code class="highlighter-rouge">FILE_STRUCTURE</code> before calling <code class="highlighter-rouge">source visualise_pathway.tcl</code>. Similarly, if you want the pathway surface coloured by a specific property, you need to set the variable <code class="highlighter-rouge">PROPERTY</code> accordingly. For example, if your data files are named <code class="highlighter-rouge">abcd.pdb</code> and <code class="highlighter-rouge">pathway.obj</code> and you want the pathway surfaced coloured by solvent density, you need to type the following:</p>

<div class="language-tcl highlighter-rouge"><pre class="highlight"><code><span class="k">set</span> FILE_STRUCTURE <span class="s2">"abcd.pdb"</span>
<span class="k">set</span> FILE_PORE_SURFACE <span class="s2">"pathway.obj"</span>
<span class="k">set</span> PROPERTY <span class="s2">"avg_density"</span>
<span class="nb">source</span> visualise_pathway.tcl
</code></pre>
</div>

<p>You can also pass arguments to <code class="highlighter-rouge">visualise_pathway.tcl</code> if you are loading it at VMD start-up, by using the <code class="highlighter-rouge">-args</code> flag to set the PDB file name, OBJ file name, and property name (in this order):</p>

<div class="language-tcl highlighter-rouge"><pre class="highlight"><code>vmd -e visualise_pathway.tcl -args abcd.pdb pathway.obj avg_density
</code></pre>
</div>

<p>Note that in this case all three arguments need to be set explicitly.</p>
</div>
            <p class="text-center">
              <br />
              <a target="_blank" href="/_docs/visualising-results/molecular_graphics_vmd.md" class="btn btn-default githubEditButton" role="button">
                <i class="fa fa-pencil fa-lg"></i> Improve this page
              </a>
            </p>
            <hr>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/chap/docs/molecular_graphics_pymol/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/chap/docs/vdw_radii/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
    </div>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            CHAP 2018 |
            Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/chap'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/chap/js/bootstrap.min.js "></script>
<script src="/chap/js/typeahead.bundle.min.js "></script>

<script src="/chap/js/main.js "></script>

</body>

</html>
